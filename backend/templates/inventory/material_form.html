{% extends 'base.html' %}

{% block title %}{% if material %}Edit Material{% else %}Add Material{% endif %} - Inventory{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'material-list-web' %}">Materials</a></li>
                <li class="breadcrumb-item active">{% if material %}Edit{% else %}Add{% endif %} Material</li>
            </ol>
        </nav>
        <h2><i class="bi bi-box me-2"></i>{% if material %}Edit Material{% else %}Add New Material{% endif %}</h2>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-body">
                <form method="post"
                    action="{% if material %}{% url 'material-edit-web' material.id %}{% else %}{% url 'material-create-web' %}{% endif %}">
                    {% csrf_token %}

                    <div class="mb-3">
                        <label for="material_name" class="form-label">Material Name <span
                                class="text-danger">*</span></label>
                        <input type="text" class="form-control {% if errors.material_name %}is-invalid{% endif %}"
                            id="material_name" name="material_name" value="{{ material.material_name|default:'' }}"
                            required>
                        {% if errors.material_name %}
                        <div class="invalid-feedback">{{ errors.material_name }}</div>
                        {% endif %}
                    </div>

                    <div class="mb-3">
                        <label for="material_type" class="form-label">Material Type <span
                                class="text-danger">*</span></label>
                        <select class="form-select {% if errors.material_type %}is-invalid{% endif %}"
                            id="material_type" name="material_type" required>
                            <option value="">Select Material Type</option>
                            {% for type in material_types %}
                            <option value="{{ type.id }}" {% if material and material.material_type.id==type.id
                                %}selected{% endif %}>
                                {{ type.material_type_name }} ({{ type.unit_of_measurement }})
                            </option>
                            {% endfor %}
                        </select>
                        {% if errors.material_type %}
                        <div class="invalid-feedback">{{ errors.material_type }}</div>
                        {% endif %}
                        <div class="form-text">
                            <a href="{% url 'material-type-create-web' %}" target="_blank">
                                <i class="bi bi-plus-circle me-1"></i>Add new material type
                            </a>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="unit_price" class="form-label">Unit Price (â‚¹) <span
                                        class="text-danger">*</span></label>
                                <input type="number" step="0.01" min="0"
                                    class="form-control {% if errors.unit_price %}is-invalid{% endif %}" id="unit_price"
                                    name="unit_price" value="{{ material.unit_price|default:'0.00' }}" required>
                                {% if errors.unit_price %}
                                <div class="invalid-feedback">{{ errors.unit_price }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="current_quantity" class="form-label">Current Quantity <span
                                        class="text-danger">*</span></label>
                                <input type="number" step="0.01" min="0"
                                    class="form-control {% if errors.current_quantity %}is-invalid{% endif %}"
                                    id="current_quantity" name="current_quantity"
                                    value="{{ material.current_quantity|default:'0.00' }}" required>
                                {% if errors.current_quantity %}
                                <div class="invalid-feedback">{{ errors.current_quantity }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    {% if form_error %}
                    <div class="alert alert-danger">
                        <i class="bi bi-exclamation-triangle me-2"></i>{{ form_error }}
                    </div>
                    {% endif %}

                    <div class="d-flex justify-content-between">
                        <a href="{% url 'material-list-web' %}" class="btn btn-secondary">
                            <i class="bi bi-arrow-left me-2"></i>Cancel
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-save me-2"></i>{% if material %}Update{% else %}Create{% endif %} Material
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0"><i class="bi bi-info-circle me-2"></i>Information</h6>
            </div>
            <div class="card-body">
                <p class="small text-muted">
                    <strong>Material Name:</strong> Enter a unique name for the raw material.
                </p>
                <p class="small text-muted">
                    <strong>Material Type:</strong> Select the type of material. This determines the unit of
                    measurement.
                </p>
                <p class="small text-muted">
                    <strong>Unit Price:</strong> The cost per unit of this material.
                </p>
                <p class="small text-muted">
                    <strong>Current Quantity:</strong> The current stock quantity available.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}